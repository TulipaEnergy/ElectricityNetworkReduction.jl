var documenterSearchIndex = {"docs":
[{"location":"01-introduction/#Introduction","page":"Introduction","title":"Introduction","text":"","category":"section"},{"location":"01-introduction/#Overview","page":"Introduction","title":"Overview","text":"ElectricityNetworkReduction.jl is a high-performance Julia package for physics-preserving reduction and equivalencing of large-scale electrical transmission networks. It provides a mathematically rigorous and computationally efficient workflow for reducing full transmission system models into compact equivalent networks while preserving their power transfer characteristics, congestion behaviour, and operational limits.\n\nThe package is specifically designed for power system studies where full network models are too large or computationally expensive to embed inside:\n\nOptimal Power Flow (OPF)\nUnit Commitment (UC)\nMarket simulation\nAdequacy and planning studies\nLong-term energy system models\n\nIt enables users to replace large meshed networks with accurate reduced equivalents at zonal, regional, national, or continental scale.\n\n","category":"section"},{"location":"01-introduction/#Modelling-scope","page":"Introduction","title":"Modelling scope","text":"ElectricityNetworkReduction.jl implements a DC power flow based network equivalencing framework built on the following modelling principles:\n\nLinearized DC power flow physics\nExact Y-bus matrix formulation\nTopology-preserving Kron reduction\nPTDF-based transfer representation\nTTC-based interzonal capacity preservation\nOptimization-based equivalent line fitting\n\nThe reduced network preserves:\n\nInter-zonal transfer capability\nCongestion behaviour\nElectrical coupling between zones\nPower flow sensitivities\nTransfer bottlenecks\n\nThis allows the reduced network to reproduce the operational behaviour of the original system with orders-of-magnitude lower computational burden.\n\n","category":"section"},{"location":"01-introduction/#What-problems-does-it-solve?","page":"Introduction","title":"What problems does it solve?","text":"Large-scale power system models (ENTSO-E scale, national grids, offshore grids, energy island networks) often contain thousands of buses, tens of thousands of branches with complex meshed topologies. Embedding such detailed models within optimisation frameworks typically results in long solution times, memory bottlenecks, poor numerical conditioning, and limited scalability.\n\nElectricityNetworkReduction.jl solves this by:\n\nReducing thousands of buses into tens of representative nodes\nPreserving inter-zonal power transfer limits\nMaintaining physical consistency of flows\nProducing compact equivalent networks for fast simulation\n\nThis enables fast, accurate, and scalable power system studies.\n\n","category":"section"},{"location":"01-introduction/#Workflow-at-a-glance","page":"Introduction","title":"Workflow at a glance","text":"Load and clean data – Read the raw data, remove invalid entries, assign consistent IDs, and convert everything to per-unit values.\nAnalyse the original grid – Build the Y-bus, compute PTDF matrices for canonical transactions, and derive TTC limits using the original line capacities.\nSelect representative nodes – Group buses by zone/area, then keep the nodes with the highest interconnection degree to serve as the reduced network boundary.\nKron reduction and reduced PTDFs – Eliminate non-representative nodes while preserving admittance relationships, and recompute PTDFs on the reduced system.\nOptimize equivalent capacities – Solve a linear/quadratic/or linearized MIQP program (via JuMP+HiGHS/Ipopt) to find synthetic line capacities that reproduce the canonical TTC limits within tolerance.\nCompare and export – Generate CSV reports (bus maps, TTC comparison, PTDF results, equivalent capacities) so you can inspect or downstream the reduced model.\n\n","category":"section"},{"location":"01-introduction/#Target-audience","page":"Introduction","title":"Target audience","text":"This package is intended for Transmission System Operators (TSOs), grid planning analysts, and energy system researchers involved in large-scale interconnection studies or long-term planning.\n\n","category":"section"},{"location":"01-introduction/#License","page":"Introduction","title":"License","text":"","category":"section"},{"location":"01-introduction/#Citation","page":"Introduction","title":"Citation","text":"If you use this package in academic work, please cite:\n\nElectricityNetworkReduction.jl – A Julia Toolkit for Power System Network Reduction and Equivalencing","category":"section"},{"location":"03-model-usage/#Model-Usage-Guide","page":"Model Usage","title":"Model Usage Guide","text":"This guide will walk you through setting up your environment, installing ElectricityNetworkReduction.jl, and running your first network reduction analysis.\n\n","category":"section"},{"location":"03-model-usage/#1.-Installing-Julia-and-VS-Code","page":"Model Usage","title":"1. Installing Julia and VS Code","text":"To use this package, you first need to install the Julia programming language and a suitable code editor.\n\nInstall Julia: Download the latest stable version from the official Julia website.\nInstall VS Code: While you can run Julia from a terminal, we recommend Visual Studio Code with the Julia Extension installed for a better development experience.\n\n","category":"section"},{"location":"03-model-usage/#2.-Installing-ElectricityNetworkReduction.jl","page":"Model Usage","title":"2. Installing ElectricityNetworkReduction.jl","text":"","category":"section"},{"location":"03-model-usage/#Starting-Julia","page":"Model Usage","title":"Starting Julia","text":"Choose one of the following:\n\nIn VS Code: Press CTRL+Shift+P, type \"Julia: Start REPL\", and press Enter.\nIn Terminal: Type julia and press Enter.","category":"section"},{"location":"03-model-usage/#Adding-the-Package-and-Dependencies","page":"Model Usage","title":"Adding the Package and Dependencies","text":"The ElectricityNetworkReduction module requires several key libraries for optimization and data handling, including JuMP, DataFrames, XLSX, and solvers like HiGHS and Ipopt.\n\nRun the following commands to install the package directly from GitHub:\n\nusing Pkg\nPkg.add(url=\"https://github.com/TulipaEnergy/ElectricityNetworkReduction.jl.git\")\nPkg.instantiate()","category":"section"},{"location":"03-model-usage/#Verifying-the-Installation","page":"Model Usage","title":"Verifying the Installation","text":"Press backspace to return to the standard Julia prompt and run:\n\nusing ElectricityNetworkReduction\n\nTo check if the package is active, enter help mode by pressing ? and search for a core function:\n\nhelp?> main_full_analysis\n\nIf you see the documentation for the function, the installation was successful!","category":"section"},{"location":"03-model-usage/#3.-Preparing-Input-Data-for-Analysis","page":"Model Usage","title":"3. Preparing Input Data for Analysis","text":"Before running the model, the input grid data must be properly organised. The model supports input data in Excel (.xlsx) or CSV formats and identifies datasets based on predefined sheet names (for Excel) or file names (for CSV).\n\n","category":"section"},{"location":"03-model-usage/#Required-Sheet-/-File-Names","page":"Model Usage","title":"Required Sheet / File Names","text":"Your input dataset must include the following four sheets (or corresponding CSV files):\n\nLines – Branch parameters for the internal network\nTielines – Parameters for lines connecting different zones or areas\nNodes – Bus-level network information\nGenerators – Generator data\nNote: Generator data is required for the data-loading stage but is not currently used in the network reduction physics. It is reserved for future model extensions.","category":"section"},{"location":"03-model-usage/#Data-Fields-and-Units","page":"Model Usage","title":"Data Fields and Units","text":"The model constructs the bus admittance matrix (Y_bus) and computes PTDFs based on the physical parameters provided. Correct specification of units is critical, especially when performing per-unit (p.u.) conversions.","category":"section"},{"location":"03-model-usage/#Lines-and-Tielines-Sheets","page":"Model Usage","title":"Lines and Tielines Sheets","text":"The following parameters are required for both Lines and Tielines:\n\nParameter Description\nFrom-node / To-node Connection points of the branch\nResistance (R) Series resistance\nReactance (X) Series reactance\nShunt Susceptance (B) Total shunt susceptance\n\nUnit SensitivityIf R, X, B are already provided in per-unit (p.u.), no additional electrical parameters are required.\nIf R, X, B are provided in Ohms, you must also specify:\nVoltage level (kV)\nCurrent rating (A)Without these values, the model cannot perform per-unit conversion, which will lead to incorrect results.","category":"section"},{"location":"03-model-usage/#Nodes-Sheet","page":"Model Usage","title":"Nodes Sheet","text":"The following fields are required to define network hierarchy and support Kron reduction:\n\nBus name or number – Unique bus identifier\nType – Load, Generator, or Slack bus\nArea – Geographic or administrative region\nZone – Grouping used to determine representative nodes","category":"section"},{"location":"03-model-usage/#4.-How-to-Run-a-Case-Study","page":"Model Usage","title":"4. How to Run a Case Study","text":"This section explains how to configure and execute a complete network reduction case study using ElectricityNetworkReduction.jl, and how to interpret the generated outputs. A first-time user should be able to follow these steps end-to-end to successfully run a model.","category":"section"},{"location":"03-model-usage/#Step-1:-Set-the-Configuration","page":"Model Usage","title":"Step 1: Set the Configuration","text":"All model behaviour is controlled through the global CONFIG object. Before running a case study, you should update the relevant configuration parameters to match your input data and study objectives.\n\nusing NetworkReduction\n\n# Example configuration\nCONFIG.input_filename = \"case118.xlsx\"      # Input Excel file name\nCONFIG.case_study = \"case118\"             # Case study identifier\nCONFIG.optimization_type = \"QP\"           # Options: \"QP\", \"LP\", or \"MIQP\"\nCONFIG.base              = 100.0          # System MVA base\nCONFIG.bus_names_as_int  = false           # true if bus IDs are integers, false if strings\nCONFIG.in_pu             = false           # true if input data (R, X, B) are already in per-unit\nCONFIG.ptdf_epsilon = 0.001               # PTDF zero threshold\nCONFIG.suffix = \"QP\"                      # Output file suffix","category":"section"},{"location":"03-model-usage/#Key-Configuration-Parameters","page":"Model Usage","title":"Key Configuration Parameters","text":"Input_filename:\n\nName of the input data file (Excel or CSV). This file must exist inside the specified input directory (test/inputs/) and contain the required sheets/files (Lines, Tielines, Nodes, Generators).\n\nOptimization_type:\n\nSelects the method used to determine equivalent line capacities:\n\n\"QP\": Quadratic Programming (recommended default)\n\"LP\": Linear Programming\n\"MIQP\": Mixed-Integer formulation (binding line selection)\nbase:\n\nSystem base power in MVA. All results are internally computed in per-unit and exported in MW using this base.\n\nbusnamesas_int:\n\nSet to true if bus identifiers are numeric (e.g. 101, 205), or false if they are strings (e.g. \"Bus_101\").\n\nin_pu:\n\nSet to true if line parameters (R, X, B) are already provided in per-unit. If false, the model will convert values from physical units using voltage and current ratings.","category":"section"},{"location":"03-model-usage/#Step-2:-Specify-Input-and-Output-Directories","page":"Model Usage","title":"Step 2: Specify Input and Output Directories","text":"The model separates input data from output results. You must explicitly provide the directories when running a case study.\n\ninput_dir  = \"test/inputs/case118\"\noutput_dir = \"test/outputs/case118\"\n\nInput directory:\n\nContains the grid data file specified by CONFIG.input_filename.\n\nOutput directory:\n\nWill be created automatically (if it does not exist) and populated with all intermediate and final results.","category":"section"},{"location":"03-model-usage/#Step-3:-Execute-the-Full-Analysis-Pipeline","page":"Model Usage","title":"Step 3: Execute the Full Analysis Pipeline","text":"Once the configuration and directories are set, run the full automated workflow:\n\nresults = main_full_analysis(input_dir, output_dir)\n\nThis single function call performs the complete pipeline:\n\nLoads and validates the input data\nBuilds the full-network admittance matrix (Y_bus)\nComputes PTDFs for the original network\nSelects representative nodes per zone\nApplies Kron reduction\nComputes PTDFs for the reduced network\nOptimizes equivalent line capacities\nExports all results to disk\n\nProgress information and solver status messages are printed to the console during execution.","category":"section"},{"location":"03-model-usage/#5.-Reviewing-the-Results","page":"Model Usage","title":"5. Reviewing the Results","text":"After the run completes, the output directory will contain several CSV files documenting each stage of the network reduction process.","category":"section"},{"location":"03-model-usage/#Key-Output-Files","page":"Model Usage","title":"Key Output Files","text":"Equivalent_Capacities.csv:\n\nContains the optimized capacities of synthetic lines in the reduced network. These capacities define the thermal limits of the equivalent model and are expressed in MW on the specified base.\n\nTTC_Comparison.csv:\n\nProvides a detailed comparison of Total Transfer Capacities (TTCs) between the original full network and the reduced equivalent network.  This file includes absolute and percentage errors, allowing you to assess how accurately the reduced model preserves inter-zonal transfer limits.\n\nPTDFReducedNetwork.csv:\n\nContains Power Transfer Distribution Factors (PTDFs) for the reduced network. These sensitivities can be directly used in optimisation models such as DC OPF, unit commitment, or market simulations.","category":"section"},{"location":"03-model-usage/#Interpreting-the-Results","page":"Model Usage","title":"Interpreting the Results","text":"A successful reduction should exhibit:\n\nSmall TTC mismatches (typically < 1–2%)\nPhysically consistent flow sensitivities\nA significantly reduced network size (tens of nodes instead of thousands)\n\nIf large TTC errors are observed, users should review:\n\nzone definitions,\nrepresentative node selection,\nunit consistency (per-unit vs physical units),\nsolver configuration.","category":"section"},{"location":"03-model-usage/#Advanced:-Interpreting-Results","page":"Model Usage","title":"Advanced: Interpreting Results","text":"If the optimization fails to converge, consider:\n\nChecking Connectivity: Ensure all representative nodes are electrically connected in the original network.\nAdjusting Lambda: Increase lambda in CONFIG if synthetic capacities are fluctuating significantly.\nBig-M Factor: For \"MIQP\" (MILP), adjust the bigM_factor if binding constraints are not being identified correctly.\n\n","category":"section"},{"location":"contributing/#Contributing-Guidelines","page":"Contributing Guidelines","title":"Contributing Guidelines","text":"Great that you want to contribute to the development of the ElectricityNetworkReduction.jl! Please read these guidelines to get you started.","category":"section"},{"location":"contributing/#GitHub-Rules-of-Engagement","page":"Contributing Guidelines","title":"GitHub Rules of Engagement","text":"If you want to discuss something that isn't immediately actionable, post under Discussions. Convert it to an issue once it's actionable.\nAll PR's should have an associated issue (unless it's a very minor fix).\nAssign yourself to issues you want to address. Consider if you will be able to work on them in the near future (this week) — if not, leave them available for someone else.\nWhen finalizing a pull request, set the Status to \"Ready for Review.\" If someone specific needs to review it, assign them as the reviewer (otherwise anyone can review).\nIssues without updates for 60 days (and PRs without updates in 30 days) will be labelled as \"stale\" and filtered out of view. There is a Stale project board to view and rev","category":"section"},{"location":"contributing/#Contributing-Workflow","page":"Contributing Guidelines","title":"Contributing Workflow","text":"Fork → Branch → Code → Push → Pull → Squash & Merge\n\nFork the repository (once)\nCreate a new branch (in your fork)\nDo fantastic coding\nPush to your fork\nCreate a pull request from your fork to the main repository\n(After review) Squash and merge","category":"section"},{"location":"02-mathematical-formulation/#Mathematical-formulation","page":"Mathematical Formulation","title":"Mathematical formulation","text":"This document presents the mathematical foundations of the ElectricityNetworkReduction.jl model. The objective of the model is to construct a reduced electrical network that preserves the power transfer characteristics of the original system while significantly reducing its size.\n\n","category":"section"},{"location":"02-mathematical-formulation/#1.-Network-admittance-matrix-(Y_{bus})","page":"Mathematical Formulation","title":"1. Network admittance matrix (Y_bus)","text":"The electrical network is represented by its nodal admittance matrix:\n\nY = G + jB\n\nIn the DC power flow approximation, we focus on the susceptance matrix (B), assuming conductance (G) is negligible. Each transmission line between buses i and j is defined by its series admittance y_ij = frac1R_ij + jX_ij. Including shunt susceptance B_ij, the Y_bus is assembled as:\n\nDiagonal elements (Y_ii): Represent the sum of all admittances connected to bus i, including shunt susceptances:   Y_ii = sum_j in mathcalN(i) left( y_ij + jfracB_ij2 right) + (G_i^shunt + jB_i^shunt)\nOff-diagonal elements (Y_ij): Represent the negative of the admittance between buses i and j:   Y_ij = -y_ij\n\n","category":"section"},{"location":"02-mathematical-formulation/#2.-DC-Power-Flow-and-PTDFs","page":"Mathematical Formulation","title":"2. DC Power Flow and PTDFs","text":"Under the DC approximation (negligible resistance, flat voltage magnitudes, small angles), active power flow is:\n\nP = B theta","category":"section"},{"location":"02-mathematical-formulation/#Power-Transfer-Distribution-Factors-(PTDF)","page":"Mathematical Formulation","title":"Power Transfer Distribution Factors (PTDF)","text":"The PTDF for a line l (from bus i to j) during a transaction between buses a and b is:\n\nPTDF_l^a to b = b_ij (theta_i^a to b - theta_j^a to b)\n\nIn the code, this is solved by calculating the sensitivity of bus angles to injections at buses a and b relative to a slack bus.\n\n","category":"section"},{"location":"02-mathematical-formulation/#3.-Total-Transfer-Capacity-(TTC)","page":"Mathematical Formulation","title":"3. Total Transfer Capacity (TTC)","text":"The TTC for a transaction t (from a to b) is the maximum power flow possible before any line hits its thermal limit C_l:\n\nTTC_t = min_l in textLines left( fracC_lPTDF_tl right)\n\n","category":"section"},{"location":"02-mathematical-formulation/#4.-Network-Reduction-(Kron)","page":"Mathematical Formulation","title":"4. Network Reduction (Kron)","text":"To reduce the system size, the network nodes are partitioned into Representative Nodes (R), which are kept, and Eliminated Nodes (E), which are removed:\n\nY = beginbmatrix Y_RR  Y_RE  Y_ER  Y_EE endbmatrix\n\nUsing the Kron Reduction method, we derive a reduced admittance matrix Y_reduced that maintains the exact electrical behavior seen from the representative nodes:\n\nY_reduced = Y_RR - Y_RE Y_EE^-1 Y_ER\n\n","category":"section"},{"location":"02-mathematical-formulation/#5.-Optimization-of-Equivalent-Capacities","page":"Mathematical Formulation","title":"5. Optimization of Equivalent Capacities","text":"The package identifies synthetic capacities C_l^eq for the reduced network to match the original TTC^orig. Based on optimization.jl, three methods are available:","category":"section"},{"location":"02-mathematical-formulation/#5.1-Quadratic-Programming-(QP)","page":"Mathematical Formulation","title":"5.1 Quadratic Programming (QP)","text":"Objective: Minimize the squared error between original and equivalent TTC, with a regularization term to keep capacities realistic.\n\nmin sum_t in mathcalT (TTC_t^eq - TTC_t^orig)^2 + lambda sum_l in mathcalL_red (C_l^eq)^2\n\nConstraints:\n\nFlow Limit: For every transaction t and every synthetic line l: TTC_t^eq cdot PTDF_tl le C_l^eq quad forall t forall l\nNon-negativity: C_l^eq ge 0 quad TTC_t^eq ge 0","category":"section"},{"location":"02-mathematical-formulation/#5.2-Linear-Programming-(LP)","page":"Mathematical Formulation","title":"5.2 Linear Programming (LP)","text":"Objective: Maximize the total transfer capacity of the reduced network while ensuring it never exceeds the original limits.\n\nmax sum_t in mathcalT TTC_t^eq\n\nConstraints:\n\nUpper Bound: TTC_t^eq le TTC_t^orig quad forall t\nPhysical Limit: TTC_t^eq cdot PTDF_tl le C_l^eq quad forall t forall l","category":"section"},{"location":"02-mathematical-formulation/#5.3-MIQP-(Original-Mixed-Integer-Quadratic-Programming)","page":"Mathematical Formulation","title":"5.3 MIQP (Original Mixed-Integer Quadratic Programming)","text":"This formulation is used when we want to identify which synthetic line is binding (limiting) for each transaction.","category":"section"},{"location":"02-mathematical-formulation/#Decision-Variables","page":"Mathematical Formulation","title":"Decision Variables","text":"Synthetic line capacities: C_l^eq ge 0\nEquivalent TTC values: TTC_t^eq ge 0:\nBinding indicator: (z_tl = 1 means line l limits transaction t) z_tl in 01: b","category":"section"},{"location":"02-mathematical-formulation/#Objective","page":"Mathematical Formulation","title":"Objective","text":"min sum_tinmathcalT (TTC_t^eq-TTC_t^orig)^2 + lambdasum_linmathcalL (C_l^eq)^2","category":"section"},{"location":"02-mathematical-formulation/#Constraints","page":"Mathematical Formulation","title":"Constraints","text":"General physical TTC upper bound: TTC_t^eq le fracC_l^eqPTDF_tlqquad forall tl\nExactly one binding line per transaction: sum_linmathcalL z_tl = 1 qquad forall t\nBig-M binding constraint (enforcing equality on chosen line): fracC_l^eqPTDF_tl - TTC_t^eq le M(1-z_tl) qquad forall tl","category":"section"},{"location":"02-mathematical-formulation/#5.4-Linearized-MIQP-MILP","page":"Mathematical Formulation","title":"5.4 Linearized MIQP → MILP","text":"To make the MIQP practical for large networks, the implementation uses a linearized MILP solved by HiGHS.","category":"section"},{"location":"02-mathematical-formulation/#Decision-Variables-(MILP)","page":"Mathematical Formulation","title":"Decision Variables (MILP)","text":"Synthetic line capacity: C_l^eq ge 0\nEquivalent TTC: TTC_t^eq ge 0\nBinding selection: b_tlin01\nAllocated capacity for transaction t on line l: Z_tlge 0\nabsolute TTC error (L1 linearization): V_t^absge 0","category":"section"},{"location":"02-mathematical-formulation/#Objective-(L1-TTC-matching)","page":"Mathematical Formulation","title":"Objective (L1 TTC matching)","text":"min sum_tinmathcalT V_t^abs\n\nLinearization of absolute value: V_t^abs ge TTC_t^eq-TTC_t^orig qquad forall t V_t^abs ge TTC_t^orig-TTC_t^eq qquad forall t","category":"section"},{"location":"02-mathematical-formulation/#MILP-Constraints","page":"Mathematical Formulation","title":"MILP Constraints","text":"","category":"section"},{"location":"02-mathematical-formulation/#A)-TTC-definition-using-allocated-capacity-Z","page":"Mathematical Formulation","title":"A) TTC definition using allocated capacity Z","text":"TTC_t^eq = sum_linmathcalL_t fracZ_tlPTDF_tl qquad forall t","category":"section"},{"location":"02-mathematical-formulation/#B)-Capacity-allocation-limits","page":"Mathematical Formulation","title":"B) Capacity allocation limits","text":"Z_tl le C_l^eqqquad forall tl","category":"section"},{"location":"02-mathematical-formulation/#C)-Exactly-one-binding-line-per-transaction","page":"Mathematical Formulation","title":"C) Exactly one binding line per transaction","text":"sum_linmathcalL_t b_tl = 1qquad forall t","category":"section"},{"location":"02-mathematical-formulation/#D)-Big-M-logic","page":"Mathematical Formulation","title":"D) Big-M logic","text":"if b_tl=1, then Z_tl=C_l^eq\nif b_tl=0, then Z_tl=0\n\nZ_tl le M_Z b_tlqquad forall tl\n\nZ_tl ge C_l^eq - M_Z(1-b_tl)qquad forall tl","category":"section"},{"location":"02-mathematical-formulation/#E)-Numerical-stability-bounds","page":"Mathematical Formulation","title":"E) Numerical stability bounds","text":"TTC_t^eq le M_TTCqquad forall t","category":"section"},{"location":"02-mathematical-formulation/#Important-Implementation-Notes","page":"Mathematical Formulation","title":"Important Implementation Notes","text":"PTDF Epsilon: The optimization ignores lines where PTDF  epsilon (defined in config.jl) to avoid numerical instability (division by zero).\nMW Conversion: While the optimization typically occurs in per-unit (p.u.), the main-analysis.jl script converts final C_l^eq results to MW using the Sbase defined in CONFIG.\nRegularization (lambda): The lambda parameter is crucial. Without it, the solver may assign infinitely high capacities to lines that don't participate in any binding constraints. A small lambda (e.g., 10^-6) ensures the smallest sufficient capacity is chosen.","category":"section"},{"location":"#Documentation-Contents","page":"Home","title":"Documentation Contents","text":"Use the navigation to explore the following sections:\n\nIntroduction: Overview of the package, goals, and high-level workflow.\nMathematical Formulation: Deep dive into the Y_bus construction, Kron reduction, and capacity optimization algorithms.\nModel Usage: Installation guides, configuration settings, and how to run your first case study.\nAPI Reference: Detailed documentation of functions and types.\nContributing Guidelines: Contributing guidelines for developers\n\n","category":"section"},{"location":"04-api/#API-Reference","page":"API Reference","title":"API Reference","text":"","category":"section"},{"location":"04-api/#Exported-Functions","page":"API Reference","title":"Exported Functions","text":"This section provides an overview of the main exported functions in ElectricityNetworkReduction.jl, grouped by their role in the overall workflow. These functions are designed to support data ingestion, physical modeling, network reduction, optimization, and result export.\n\n","category":"section"},{"location":"04-api/#1.-Data-Loading-and-Cleaning","page":"API Reference","title":"1. Data Loading and Cleaning","text":"These functions handle the initial stage of reading input data from Excel or CSV files and preparing it for mathematical modeling.\n\nload_excel_data(file_path) Reads the mandatory Lines, Tielines, Nodes, and Generators sheets from an Excel input file and returns structured data frames.\nclean_line_data(lines_df) Cleans branch data by removing self-loops and assigning unique identifiers to missing or incomplete EIC codes.\nprocess_tielines(tielines_df) Processes inter-zonal transmission lines to ensure consistent representation of connections across zone boundaries.\nconvert_line_to_pu!(df, baseMVA) Converts line parameters from physical units (Ohms) to per-unit values using Voltage (kV) and Current (A), if required. This function modifies the data frame in place.\n\n","category":"section"},{"location":"04-api/#2.-Network-Physics-and-Matrix-Construction","page":"API Reference","title":"2. Network Physics and Matrix Construction","text":"These functions construct the mathematical representation of the electrical network.\n\nform_ybus_with_shunt(nodes, lines) Assembles the bus admittance matrix (Y_bus), including the contribution of line shunt susceptances.\ncalculate_ptdfs_dc_power_flow(ybus) Computes Power Transfer Distribution Factors (PTDFs) using DC power flow assumptions.\ncalculate_ttc_from_ptdfs(ptdfs, capacities) Calculates the original Total Transfer Capacities (TTCs) for a set of transactions based on PTDFs and line limits.\n\n","category":"section"},{"location":"04-api/#3.-Network-Reduction-Logic","page":"API Reference","title":"3. Network Reduction Logic","text":"These functions implement the core algorithms used to reduce the size of the network while preserving its physical behavior.\n\nselect_representative_nodes(nodes_df, zone) Identifies boundary or representative nodes within each zone based on interconnection degree and network topology.\nkron_reduce_ybus(ybus, representative_nodes) Applies Kron reduction to eliminate internal nodes while preserving sensitivity relationships between representative nodes.\n\n","category":"section"},{"location":"04-api/#4.-Capacity-Optimization","page":"API Reference","title":"4. Capacity Optimization","text":"These functions use mathematical programming to determine synthetic line capacities for the reduced network.\n\noptimize_equivalent_capacities(ttc_orig, ptdf_red) Primary interface for solving the capacity fitting problem using LP, QP, or MIQP formulations.\n\n","category":"section"},{"location":"04-api/#5.-Workflow-and-Configuration","page":"API Reference","title":"5. Workflow and Configuration","text":"These functions and objects control the full end-to-end execution of the model.\n\nmain_full_analysis(input_dir, output_dir) High-level wrapper that executes the complete network reduction pipeline, from data loading to result export.\nCONFIG Global configuration object containing parameters such as optimization_type, lambda, ptdf_epsilon, base power, and unit settings.\nreset_config!() Resets all configuration parameters to their default values.\n\n","category":"section"},{"location":"04-api/#Internal-Module-Structure","page":"API Reference","title":"Internal Module Structure","text":"The package follows a modular architecture, with each file responsible for a specific component of the workflow.\n\nFile Responsibility\nconfig.jl Centralized settings and global constants\ndata-loading.jl Excel/CSV ingestion and per-unit normalization\nexport-functions.jl CSV export and reporting utilities\nkron-reduction.jl Mathematical node elimination\nmain-analysis.jl The top-level wrapper executing the full pipeline\noptimization.jl JuMP models for LP, QP, and MILP formulations [cite: 11]\nptdf-calculations.jl DC power flow sensitivity analysis\nrepresentative-nodes.jl Groups buses and identifies the \"boundary\" nodes to keep based on their connectivity degree\nttc-calculations.jl Transfer capacity evaluation [cite: 10]\nybus-formation.jl Physical matrix assembly (Y_bus)","category":"section"},{"location":"04-api/#ElectricityNetworkReduction._solve_miqp_model-Tuple{Vector{Float64}, Vector{Tuple{Int64, Int64}}, UnitRange{Int64}, UnitRange{Int64}, Dict{Tuple{Int64, Int64}, Float64}, Vector{Vector{Int64}}, Vector{Vector{Int64}}}","page":"API Reference","title":"ElectricityNetworkReduction._solve_miqp_model","text":"Linearized MILP formulation using Ipopt that enforces exactly one binding line per transaction. Objective: minimize sum of absolute TTC errors (L1 norm).\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.calculate_all_ttc_results-Tuple{SparseArrays.SparseMatrixCSC{ComplexF64}, DataFrames.DataFrame, DataFrames.DataFrame}","page":"API Reference","title":"ElectricityNetworkReduction.calculate_all_ttc_results","text":"calculate_all_ttc_results(Ybus, lines_df, tie_lines_df)\n\nComputes TTC for all canonical transactions (a < b) WITHOUT storing PTDFs. Memory-optimized for large-scale systems.\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.calculate_single_injection_ptdfs-Tuple{SparseArrays.SparseMatrixCSC{ComplexF64}}","page":"API Reference","title":"ElectricityNetworkReduction.calculate_single_injection_ptdfs","text":"calculate_single_injection_ptdfs(Ybus; reference_bus=1)\n\nCore Engine: Factorizes B matrix once and solves for unit injections.\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.calculate_ttc_from_ptdfs-Tuple{DataFrames.DataFrame, Dict{Tuple{Int64, Int64}, Float64}}","page":"API Reference","title":"ElectricityNetworkReduction.calculate_ttc_from_ptdfs","text":"calculate_ttc_from_ptdfs(ptdf_df, line_capacities)\n\nCalculate the Total Transfer Capacity (TTC) for every canonical transaction (A < B). Returns DataFrame with TTC values and limiting line information.\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.clean_line_data-Tuple{DataFrames.DataFrame}","page":"API Reference","title":"ElectricityNetworkReduction.clean_line_data","text":"clean_line_data(lines_df::DataFrame)\n\nClean line data by removing self-loops and assigning fake EIC codes to missing entries.\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.convert_line_to_pu!-Tuple{DataFrames.DataFrame, Float64}","page":"API Reference","title":"ElectricityNetworkReduction.convert_line_to_pu!","text":"convert_line_to_pu!(lines_df::DataFrame, Sbase::Float64; in_pu::Bool=false)\n\nConvert line parameters to per-unit values based on system base power. If in_pu is true, assumes R, X, B are already in per-unit and only converts capacity.\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.create_ttc_results_from_optimization-Tuple{Vector{Float64}, DataFrames.DataFrame}","page":"API Reference","title":"ElectricityNetworkReduction.create_ttc_results_from_optimization","text":"create_ttc_results_from_optimization(\nttc_vals::Vector{Float64},\nttc_canonical::DataFrame;\nmodel=model,\nType = CONFIG.optimization_type,\nsynth_lines::Vector{Tuple{Int,Int}} = Tuple{Int,Int}[],\nbinding_dict::Union{Dict,Nothing} = nothing\n)\n\nCreate TTC results directly from optimization variables.\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.export_bus_id_map-Tuple{DataFrames.DataFrame, String}","page":"API Reference","title":"ElectricityNetworkReduction.export_bus_id_map","text":"export_bus_id_map(node_info, export_path)\n\nExport a CSV file containing the mapping between old bus names and new numerical IDs.\n\nArguments\n\nnode_info::DataFrame: Node information with oldname and newid columns\nexport_path::String: Path where the CSV file will be saved\n\nOutput CSV Format\n\nold_name: Original bus names from input data\nnew_id: Numerical IDs assigned during processing\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.export_detailed_line_info-Tuple{DataFrames.DataFrame, DataFrames.DataFrame, String}","page":"API Reference","title":"ElectricityNetworkReduction.export_detailed_line_info","text":"export_detailed_line_info(lines_df, tielines_df, export_path)\n\nExport comprehensive line information including both original names and numerical IDs.\n\nArguments\n\nlines_df::DataFrame: Regular transmission lines data\ntielines_df::DataFrame: Tie lines data\nexport_path::String: Path where the CSV file will be saved\n\nOutput CSV Columns\n\nEIC_Code: European Identification Code for the line\nFromnode, Tonode: Original bus names\nNewIDFrom, NewIDTo: Numerical bus IDs\nVoltage_level: Operating voltage level\nLength_km: Line length in kilometers\nCapacityMW, Capacitypu: Line capacity in MW and per-unit\nRpu, Xpu, B_pu: Line parameters in per-unit\nIsTieLine: Boolean flag indicating if this is a tie line\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.form_ybus_with_shunt-Tuple{DataFrames.DataFrame, DataFrames.DataFrame, DataFrames.DataFrame, Float64}","page":"API Reference","title":"ElectricityNetworkReduction.form_ybus_with_shunt","text":"form_ybus_with_shunt(lines_df, tie_lines_df, node_info, Sbase)\n\nForm the network admittance matrix (Y-bus) including shunt elements. Returns a sparse complex matrix representing the network admittance.\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.kron_reduce_ybus-Tuple{SparseArrays.SparseMatrixCSC{ComplexF64}, Vector{Int64}}","page":"API Reference","title":"ElectricityNetworkReduction.kron_reduce_ybus","text":"kron_reduce_ybus(Ybus, rep_node_ids)\n\nPerform Kron reduction on the original Ybus matrix to eliminate non-representative nodes.\n\nThe Kron reduction technique eliminates internal nodes while preserving the electrical relationships between the representative nodes. This creates an equivalent network with fewer nodes but equivalent transfer characteristics.\n\nArguments\n\nYbus::SparseMatrixCSC{ComplexF64}: Original network admittance matrix\nrep_node_ids::Vector{Int}: Indices of representative nodes to retain\n\nReturns\n\nY_kron::SparseMatrixCSC{ComplexF64}: Reduced admittance matrix\n\nMathematical Background\n\nThe Kron reduction partitions the admittance matrix as:\n\nY = [K   L_T]\n    [L   M  ]\n\nwhere K connects representative nodes, M connects eliminated nodes, and L connects representative to eliminated nodes.\n\nThe reduced matrix is: Ykron = K - LT * M^(-1) * L\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.load_excel_data-Tuple{String}","page":"API Reference","title":"ElectricityNetworkReduction.load_excel_data","text":"load_excel_data(file_path::String)\n\nLoad network data from Excel file with multiple sheets. Returns a dictionary containing DataFrames for lines, tielines, nodes, and generators.\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.main_full_analysis-Tuple{String, String}","page":"API Reference","title":"ElectricityNetworkReduction.main_full_analysis","text":"main_full_analysis()\n\nComplete network reduction analysis workflow including:\n\nData loading and preprocessing\nOriginal network PTDF/TTC analysis\nRepresentative node selection\nKron reduction\nReduced network analysis\nOptimization of equivalent capacities\nResults comparison and export\n\nReturns\n\nTuple containing:\n\nttc_results: Original network TTC calculations\nptdfreducedresults: Reduced network PTDF calculations\nequivalentcapacitiesdf: Optimized equivalent capacities\n\nData Directory\n\nModify the inputdatadir and outputdatadir variables to change the location.\n\nOutput Files\n\nBusIDMap_QP.csv: Mapping of bus names to numerical IDs\nLineDetailsQP.csv: Comprehensive line information\nRepresentativeNodesQP.csv: Selected representative nodes\nTTCOriginalNetwork_QP.csv: Original network TTC values\nPTDFReducedNetwork_QP.csv: Reduced network PTDF values\nEquivalentCapacitiesQP.csv: Optimized synthetic line capacities\nTTCComparisonQP.csv: Comparison of original vs equivalent TTC values\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.process_tielines-Tuple{DataFrames.DataFrame}","page":"API Reference","title":"ElectricityNetworkReduction.process_tielines","text":"process_tielines(tielines_df::DataFrame)\n\nProcess tie-lines by sorting, removing duplicates, and handling missing EIC codes.\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.rename_buses","page":"API Reference","title":"ElectricityNetworkReduction.rename_buses","text":"rename_buses(nodes_df, generators_df, lines_df, tie_lines_df, Sbase)\n\nRename buses to uppercase, create numerical mapping, and convert data to per-unit. Returns processed line DataFrames and node information.\n\n\n\n\n\n","category":"function"},{"location":"04-api/#ElectricityNetworkReduction.reset_config!-Tuple{}","page":"API Reference","title":"ElectricityNetworkReduction.reset_config!","text":"reset_config!()\n\nResets the global CONFIG object to its default values. Useful for batch testing multiple case studies.\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.select_representative_nodes-Tuple{SparseArrays.SparseMatrixCSC{ComplexF64}, DataFrames.DataFrame}","page":"API Reference","title":"ElectricityNetworkReduction.select_representative_nodes","text":"select_representative_nodes(Ybus, node_info)\n\nSelect a single representative node (RN) from each unique 'Zone' based on the highest interconnection degree.\n\nArguments\n\nYbus::SparseMatrixCSC{ComplexF64}: Network admittance matrix\nnode_info::DataFrame: Node information DataFrame\n\nReturns\n\nrep_nodes::DataFrame: DataFrame with selected representative nodes\nnode_info::DataFrame: Updated nodeinfo with isrepresentative flag set\n\n\n\n\n\n","category":"method"},{"location":"04-api/#ElectricityNetworkReduction.Config","page":"API Reference","title":"ElectricityNetworkReduction.Config","text":"Config\n\nCentral configuration struct for the entire network reduction workflow. Modify the default values below to run different case studies.\n\n\n\n\n\n","category":"type"}]
}
